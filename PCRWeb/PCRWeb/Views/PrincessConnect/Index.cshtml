@model PCRWeb.ViewModels.PrincessConnectViewModel
@{
    ViewBag.Title = "Index";//顯示標題用
    var allRoleList = ViewBag.List;
}
<body background="~/Images/競技場.png" style="background-size: cover; margin: 0; ">
</body>
<input id="isHide" type="submit" value="展開" onclick="hide()" />
<br>
<div>
    @for (int i = 0; i < 134; i++)
    {
        <button type="submit" id="@i" value="@(allRoleList[i])" onclick="clickImageBolder(@(i))" style="width: 70px; height: 70px; border:none;display:none; background-color:transparent;">
            <img src="~/Images/@(allRoleList[i]).png " style="width: 50px; height: 50px; border:none;" />
        </button>
    }
    <br>
    <input type="submit" id="OK" value="確認" style="display: none;" onclick="clickLink()" />
</div>
<script type="text/javascript">
    let fiveCount = 0;
    let Role = [];
    let roleCount = 134;
    let falseCount = 0;
    var pcrState = [];
    let allRoleName = "";
    let a1 = ""; let a2 = ""; let a3 = ""; let a4 = ""; let a5 = "";
    let d1 = ""; let d2 = ""; let d3 = ""; let d4 = ""; let d5 = "";
    let Note = "";
    let hideToggle = true;
    for (var i = 0; i < roleCount; i++) {
        pcrState.push(true);
    }
    function defenseClear() {
        Role = [];
        fiveCount = 0;
        for (var i = 0; i < 5; i++) {
            document.getElementById("di" + i).removeAttribute("src");
        }
    }
    function clickLink() {
        defenseClear();
        for (var i = 0; i < roleCount; i++) {
            if (pcrState[i] == false) {
                Role.push(document.getElementById(i).value);
            }
        }
        fiveCount = 0;
        for (var i = 0; i < roleCount; i++) {
            if (pcrState[i] == false) {
                var obj = document.getElementById("di" + fiveCount);
                obj.setAttribute("src", "../Images/" + Role[fiveCount] + ".png");//不能用~/Imges
                fiveCount++;
            }
        }
        hide();
        d1 = Role[0]; d2 = Role[1]; d3 = Role[2]; d4 = Role[3]; d5 = Role[4];
    }
    function hide() {
        hideToggle = !hideToggle;
        if (hideToggle) {
            document.getElementById("isHide").value = "展開";
            document.getElementById("OK").style = "display: none;";
            for (var i = 0; i < roleCount; i++) {
                document.getElementById(i).style = "border:none; width: 70px; height: 70px;background-color:transparent;display:none;";
            }
        }
        else {
            document.getElementById("isHide").value = "隱藏";
            document.getElementById("OK").removeAttribute("style");
            for (var i = 0; i < roleCount; i++) {
                document.getElementById(i).style = "border:none; width: 70px; height: 70px;background-color:transparent;";
            }
            clickAllClear();
        }

    }
    function clickAllClear() {
        falseCount = 0;
        //document.getElementById('ARN').innerHTML = "";
        allRoleName = "";
        for (var i = 0; i < roleCount; i++) {
            pcrState[i] = true;
            document.getElementById(i).style = "border:none; width: 70px; height: 70px;background-color:transparent;";
            document.getElementById(i).removeAttribute("disabled");
        }
    }

    function clickImageBolder(number) {
        falseCount = 0;
        if (pcrState[number]) {
            document.getElementById(number).style = "color:blue; border: solid 4px ; width: 70px; height: 70px;background-color:transparent;";
            pcrState[number] = !pcrState[number];
        }
        else {
            document.getElementById(number).style = "border:none;width: 70px; height: 70px;background-color:transparent;";
            pcrState[number] = !pcrState[number];
        }
        for (var i = 0; i < roleCount; i++) {
            if (pcrState[i] == false) {
                falseCount++;
            }
        }

        if (falseCount == 5) {
            for (var i = 0; i < roleCount; i++) {
                if (pcrState[i] == true) {
                    document.getElementById(i).setAttribute("disabled", "disabled");
                }
            }
        }
        else {
            for (var i = 0; i < roleCount; i++) {
                if (pcrState[i] == true) {
                    document.getElementById(i).removeAttribute("disabled");
                }
            }
        }
        for (var i = 0; i < roleCount; i++) {
            if (pcrState[i] == false) {
                allRoleName += document.getElementById(i).value + " ";
            }
        }
        //document.getElementById('ARN').innerHTML = allRoleName;
        allRoleName = "";
        falseCount = 0;
    }

    function submitForm() {
        var model = new Object();
        model.d1 = d1;
        model.d2 = d2;
        model.d3 = d3;
        model.d4 = d4;
        model.d5 = d5;
        jQuery.ajax({
            type: "POST",
            url: "@Url.Action("Search")",
            dataType: "json",
            contentType: "application/json; charset=utf-8",
            data: JSON.stringify({ p: model }),
            success: function (data) {
                alert(data);
            },
            failure: function (errMsg) {
                alert(errMsg);
            }
        });
    }
</script>

<br>
<table style="background-color:lightgray; background:rgba(255,255,255,0.5);">
    <tr>
        <td>
            &nbsp;&nbsp;&nbsp;
            防守:
            <img id="di0" style="width: 50px; height: 50px; border:none;" />
            <img id="di1" style="width: 50px; height: 50px; border:none;" />
            <img id="di2" style="width: 50px; height: 50px; border:none;" />
            <img id="di3" style="width: 50px; height: 50px; border:none;" />
            <img id="di4" style="width: 50px; height: 50px; border:none;" />
        </td>
    </tr>
</table>

<input type="button" value="查詢" onclick="submitForm()" style="background: rgba(255,255,255,0.5);" />
<table>
@Model.dataList[0].Name
</table>
@*匯入驗證欄位所需的JavaScript*@
@section Scripts {
    @Scripts.Render("~/bundles/jqueryval")
}
